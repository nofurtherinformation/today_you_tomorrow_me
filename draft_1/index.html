<html>
<head>
<meta charset=utf-8 />
<title>A simple map</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.css' rel='stylesheet' />

<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
<script src="https://gmousse.github.io/dataframe-js/dist/dataframe.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.9.2/d3.min.js" integrity="sha256-k9RyZhvMj2bg0fd8L3IE41t0HpTXnivMoePN/Ksq250=" crossorigin="anonymous"></script>
<script src = "https://d3js.org/d3-dsv.v1.min.js"></script>
<script src='geometry/geojson.js'></script>

<link href="https://fonts.googleapis.com/css?family=Assistant:400,800|Vesper+Libre" rel="stylesheet"> 

<style>
    body { 
        margin:0; 
        padding:0; 
        overflow-y:scroll;
        font-family: 'Assistant', 
        sans-serif;
    }
    h1, h2, h3, h4, h5, h6 {
        font-family: 'Vesper Libre', serif;
        padding:0 20px;
        background: white;
        box-shadow:0 0 1vw rgba(0,0,0,0.2);
    }
    p {
        padding:20px;
        background:white;
        
    box-shadow:0 0 1vw rgba(0,0,0,0.2);
    }
    #title {
        font-size:40px;
        line-height:1;
        padding-top:20px;   
        background:white;
    }

    #map { 
        position:fixed; 
        top:0; bottom:0; 
        width:100%; 
        height:100%;
        z-index:500;
        transition:250ms all;
        /* pointer-events: none; */
    }
    #scrolling-container {
      z-index:550;
      width:30vw;
      margin:25vh 0 10vh 15vw;
      height:500vh;
      position: relative;
      padding:20px;
      text-align:center;
    }
    #overlay {
        z-index:499;
        width:100%;
        height:100%;
        position:fixed;
        top:0;
        left:0;
        opacity:0;
    }
    .long-break {
        height:50vh;
    }
    .short-break {
        height:25vh;
    }
    .out_to_sea {
        translateY:(100%);
    }
    .hidden{
        display:none;
    }
#left_panel {
    width:15vw;
    height:100vh;
    position: fixed;
    left:0;
    top:0;
    background: rgba(255,255,255,0.7);
    z-index:550;
    box-shadow:0 0 1vw rgba(0,0,0,0.2);
}
#slr_meter {
    position: fixed;
    width:2vw;
    height:100vh;
    left:13vw;
    top:0;
    z-index:550;
    overflow:hidden;
}

#slr_meter #counter {
    width:1.5vw;
    height:1.5vw;
    margin:0.25vw;
    background-color: white;
    border-radius:50%;
    animation: swell 7s ease -1.25s infinite;
    position: absolute;
    bottom: 5%;
    z-index: 550;
    transition:2s bottom ease-in-out;
}
#counter p {
    padding:0;
    background:none;
    text-align:center;
    margin-top: 2px;
    font-family:'Vesper Libre', sans-serif;
    font-size:12px;
    font-weight:bold;
}
.wave_filler {
    width:100%;
    height:0;
    position: absolute;
    bottom:0;
    transition:1s height;
    background-image: linear-gradient(#025a72, #062d37);
}
.wave {
    background: url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/85486/wave.svg) repeat-x; 
  position: absolute;
  bottom: 0;
  width: 6400px;
  height: 300px;
  animation: wave 20s cubic-bezier( 0.36, 0.45, 0.63, 0.53) infinite;
  transform: translate3d(0, 0, 0);
  transition:1s all;
  background-position-y: 100%;
}

.wave:nth-of-type(2) {
  animation: wave 20s cubic-bezier( 0.36, 0.45, 0.63, 0.53) -.125s infinite, swell 7s ease -1.25s infinite;
  opacity: 1;
}
.scenarios {
    width:100%;
    padding:20px;
}
.scenarios p {
    width:5vw;
    margin:2px;
    display: inline;
    font-weight: bold;
}
.scenarios p:nth-of-type(1), .greenBG {
    background:#57FF98;
}

.scenarios p:nth-of-type(1)::before {
    content: 'optimistic: ';
    font-weight: 200;
}
.scenarios p:nth-of-type(2), .yellowBG {
    background:#FFE257;
}
.scenarios p:nth-of-type(2)::before {
    content: 'intermediate: ';
    font-weight: 200;
}
.scenarios p:nth-of-type(3), .redBG {
    background:#FF5E57;
}
.scenarios p:nth-of-type(3)::before {
    content: 'extreme: ';
    font-weight: 200;
}
@keyframes wave {
  0% {
    margin-left: 0;
  }
  100% {
    margin-left: -1600px;
  }
}

@keyframes swell {
  0%, 100% {
    transform: translate3d(0,-25px,0);
  }
  50% {
    transform: translate3d(0,5px,0);
  }
}
.show {
    width:25%;
    display:inline;
    margin:10px;
    background-color:white;
    font-weight: bold;
    text-align: center;
    padding:5px 20px;
    border-radius:20px;
    transition: 250ms all;
    box-shadow:0 0 1vw rgba(0,0,0,0.2);
}
.show_active {
    background-color: #FF5E57;

}
</style>
</head>
<body>
    <div id='map'></div>
    <div id='left_panel'>
        <div id="pixel_viz" style = "padding:15px"><svg id = "svg"> </svg></div>
        <div id="slr_meter">
            <div id="counter"><p>1</p></div>
            <div class="wave_filler"></div>
            <div class="wave"></div>
            <div class="wave wave2"></div>
        </div>
    </div>
    <div id='scrolling-container'>
            <div class="short-break"></div>
            <h1 id="title">Here Today,<br>Gone Tomorrow.</h1>
            <div class="long-break"></div>
            <h1 id="marker1"></h1>
                <p>Louisana's gulf coast is a site of incredible bio-diversity, natural beauty, and economic activity that relies on a stable ecosystem. The coast has been a site of recovery -- from the wake of Hurricane Katrina to numerous nearly-extinct species, some recoveries have been more complete than others.</p>
                <div class="short-break" id="marker2"></div>
                <p>But facing the coast is a challenge from which recovery may not be possible -- sea level rise. Fueled by climate change, ever-increasing high water marks threaten the precarious biodiversity unique to the Mississippi River Delta. Louisiana's coastal region is a sensitive and critical habtiat for a variety of species, home to:</p>
                <div id="bird_env" class="show show_active">birds</div>
                <div id="fish_env" class="show">fish</div>
                <div id="invert_env" class="show">invertibrates</div>
                <div class="short-break"></div>
            <p>And all these homes are threatened by the same thing, sea level rise.</p>  
                <div class="short-break"></div>
                <p>This page illustrates how and when this sea level rise will impact animal habitat as well as people living along the coast. Each block on the left represents an animal's habitat and will fade as that animal's habitat is displaced -- hover over it to see more information.  </p>
            <h1 id="marker3">Onward and Upward - One Foot Higher</h1>
                <p>In the best case scenario, a one foot sea level rise won't happen until <span class="greenBG">2030</span>, but in the worst case scenario, we're there <span class="redBG">next year.</span> Somewhere in the middle puts around <span class="yellowBG">2025.</span></p>
                <div class="short-break"></div>
                <p>At one foot higher, a dramatic chunk of habitat is immediately lost. Many animals may be able to shift habitats, moving inland in response. Breeding grounds, species requiring specific salinities are particularly at risk. </p>
            <h1 id="marker4">Two Feet Rise</h1>
                <div class="scenarios">
                    <p>2050</p>
                    <p>2035</p>
                    <p>2030</p>
                </div>
                <p>The Piping Plover, a shorebird making its home here on the gulf coast, is one of these species. Recent counts of the species across the entire US place its numbers around 6,500. These Plovers keep the beaches clean of bugs and small crustacians, allowing for our own enjoyment of the waterfront landscape.</p>
                <img src="https://media.giphy.com/media/3o8dpc4MgG9i3VDvDq/giphy.gif">
                <div class="long-break"></div>            
            <h1 id="marker5">Three Feet Rise</h1>
                <div class="scenarios">
                    <p>2080</p>
                    <p>2050</p>
                    <p>2035</p>
                </div>
            <p id="marker6">At three feet sea level we start to see a dramatic impact on the habitats. These areas represent the Plover's habitat.</p>
                <div class="short-break"></div>
                <p>The number of remaining Plovers has recovered since the 1990s to their current population, but that recovery may be reversed.</p>        </p>
            <h1 id="marker7">Four Feet Rise</h1>
                <div class="scenarios">
                    <p>2100</p>
                    <p>2065</p>
                    <p>2050</p>
                </div>
                <p>Here along the Mississippi River banks, as the gulf sea level rises, the plover -- alongside other species -- are forced inland to find new homes and new sources of food.</p>
            <h1 id="marker8">Five Feet Rise</h1>
            <div class="scenarios">
                <p>????</p>
                <p>2075</p>
                <p>2060</p>
            </div>
                <div class="long-break"></div>
            <h1 id="marker9">Six Feet Rise</h1>
                <div class="scenarios">
                    <p>????</p>
                    <p>2085</p>
                    <p>2065</p>
                </div>
                <p id="marker10">And it's not just the Piping Plover.</p>
                <div class="long-break"></div>
                <p>Over a hundred species have now been displaced, and current models are not confident on where they will end up. </p>
            <h1 id="marker11">Seven Feet Rise</h1>
                <div class="scenarios">
                    <p>????</p>
                    <p>2095</p>
                    <p>2075</p>
                </div>
                <p>The impacts on species have substantial effects on human activity, too. Even today, some shrimping locations have only recently recovered from pollution stemming from the Deepwater Horizon oil spill.
                    Critical habitats of 5 shrimp species for the area will be displaced, meaning that the juvenile shrimps seeking algae to feed on will need to move to new marshes and sounds. These shrimp need brackish coastal areas to fully grow, and without them Lousiana's 1.3 billion dollar shrimp industry is threatened.</p>
                <div class="long-break"></div>
            <h1 id="marker12">Eight Feet Rise</h1>
                <div class="scenarios">
                    <p>????</p>
                    <p>2100</p>
                    <p>2080</p>
                </div>
                <p>As we approach the edges of the current model, the human impact comes into clear focus. At 8 feet of sea level rise, projected to occur at the end of this century unless serious action is taken, XXX living there today people would be displaced in Louisana alone. Of those, XXX may sit below the povery line and hold less than an high school degree, putting them in particular danger for finding a new home. $XXX,XXX worth of today's housing real estate will be wiped out, and more potentially to follow. </p>
                <div class="long-break"></div>
                <p>A cold comfort, but only the most extreme models extend sea level rise beyond eight feet.</p>
            <h1 id="marker13">Nine Feet Rise</h1>
                <div class="scenarios">
                    <p>????</p>
                    <p>????</p>
                    <p>2085</p>
                </div>
                    <div class="long-break"></div>
            <h1 id="marker14">Ten Feet Rise</h1>
                <div class="scenarios">
                    <p>????</p>
                    <p>????</p>
                    <p>2090</p>
                </div>
                <h1>Here today, gone tomorrow.</h1>
                <p>We don't know where these animals and people will have to go. But we do know this is happening, and there are ways to slow down sea level rise. </p>
                <h1>Call to Action.</h1>
    </div>

    <div id="overlay"></div>
<script>

var pixel_data;
const d = d3.csv("https://gist.githubusercontent.com/kat-wicks/f205e7ccfcc730c350237b8a7d3c30fa/raw/84c1ffe852757e74df4f1d533c3097c717169fdb/slr_habitat_loss.csv",  (d, i, columns) => (d3.autoType(d))).then(function(data){
    pixel_data = data
})


var slr_tiles = [
    {'name':'slr_0', 'url':'http://dev.dylanhalpern.com/slr/slr_00/'},
    {'name':'slr_1', 'url':'http://dev.dylanhalpern.com/slr/slr_01/'},
    {'name':'slr_2', 'url':'http://dev.dylanhalpern.com/slr/slr_02/'},
    {'name':'slr_3', 'url':'http://dev.dylanhalpern.com/slr/slr_03/'},
    {'name':'slr_4', 'url':'http://dev.dylanhalpern.com/slr/slr_04/'},
    {'name':'slr_5', 'url':'http://dev.dylanhalpern.com/slr/slr_05/'},
    {'name':'slr_6', 'url':'http://dev.dylanhalpern.com/slr/slr_06/'},
    {'name':'slr_7', 'url':'http://dev.dylanhalpern.com/slr/slr_07/'},
    {'name':'slr_8', 'url':'http://dev.dylanhalpern.com/slr/slr_08/'},
    {'name':'slr_9', 'url':'http://dev.dylanhalpern.com/slr/slr_09/'},
    {'name':'slr_10', 'url':'http://dev.dylanhalpern.com/slr/slr_10/'}
]
var slr_loss = [slr_1_loss,slr_2_loss,slr_3_loss,slr_4_loss,slr_5_loss,slr_6_loss,slr_7_loss,slr_8_loss,slr_9_loss,slr_10_loss]

mapboxgl.accessToken = 'pk.eyJ1IjoiZGhhbHBlcm4iLCJhIjoiY2pvMnliandsMHJsbTNwcGhlNWhqYzF3ZyJ9.g5FiNV9s5DXPt1RaE2wNyg';

var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/dhalpern/cju007aoj560k1gplfbhlc9ft', // our map style
    center: [-91.167895, 30.179239], // gulf coast area
    zoom: 8, // regional scale zoom
});


const heatmap_vars = {
            // Increase the heatmap weight based on frequency and property magnitude
            "heatmap-weight": [
                "interpolate",
                ["linear"],
                ["get", "mag"],
                0, 0,
                6, 1
            ],
            // Increase the heatmap color weight weight by zoom level
            // heatmap-intensity is a multiplier on top of heatmap-weight
            "heatmap-intensity": [
                "interpolate",
                ["linear"],
                ["zoom"],
                0, 1,
                9, 3
            ],
            // Color ramp for heatmap.  Domain is 0 (low) to 1 (high).
            // Begin color ramp at 0-stop with a 0-transparancy color
            // to create a blur-like effect.
            "heatmap-color": [
                "interpolate",
                ["linear"],
                ["heatmap-density"],
                0, "rgba(117,107,177,0)",
                0.1, "rgb(7,92,117)",
                1, "rgb(255,255,255)"
            ],
            // Adjust the heatmap radius by zoom level
            "heatmap-radius": [
                "interpolate",
                ["linear"],
                ["zoom"],
                0, 2,
                9, 20
            ],
            // Transition from heatmap to circle layer by zoom level
            "heatmap-opacity": [
                "interpolate",
                ["linear"],
                ["zoom"],
                7, 1,
                9, 1
            ],
        };

map.on('load', function() {
    map.setPaintProperty('water', 'fill-color', '#025a72')
    slr_tiles.forEach(function(tile){
    // Insert the layer beneath any symbol layer.
        map.addSource(tile.name, {
            "type": "raster",
                "scheme": "tms",
                "tiles": [
                    tile.url + '{z}/{x}/{y}.png'
                ],
                "tileSize": 256,
        })
    })

    slr_tiles.forEach(function(tile){
        map.addLayer({
            'id': tile.name,
            'type': 'raster',
            'source': tile.name,
            'layout': {
                'visibility': 'none'
            },
            'maxZoom':12,
            'minZoom':0
        });
    })
    map.addLayer({
        'id':'coast',
        'type': 'line',
        'source': {
            'type': 'geojson',
            'data': coast
        },
        "layout": {
            "line-join": "round",
            "line-cap": "round"
        },
        "paint": {
            "line-color": "#efefef",
            "line-width": 1
        }
    })
    for(let i=0;i<10;++i){
        map.addLayer({
            'id':`slr_${i+1}_loss`,
            'type':'heatmap',
            'source':{
                'type':'geojson',
                'data':slr_loss[i],
            },
            'layout':{
                'visibility':'none'
        },
        "paint": heatmap_vars
        })
    }

    map.addLayer({
        'id':'invert_env',
        'type': 'heatmap',
        'source': {
            'type': 'geojson',
            'data': invert_env
        },
        'layout': {
            'visibility':'none'
        },
        "paint": heatmap_vars 
    })

    map.addLayer({
        'id':'bird_env',
        'type': 'heatmap',
        'source': {
            'type': 'geojson',
            'data': bird_env
        },
        'layout': {
            'visibility': 'none'
        },
        "paint": heatmap_vars   
    })
    map.addLayer({
        'id':'reptile_env',
        'type': 'heatmap',
        'source': {
            'type': 'geojson',
            'data': reptile_env
        },
        'layout': {
            'visibility':'none'
        },
        "paint": heatmap_vars               
    })
    map.addLayer({
        'id':'fish_env',
        'type': 'heatmap',
        'source': {
            'type': 'geojson',
            'data': fish_env
        },
        'layout': {
            'visibility':'none'
        },
        "paint": heatmap_vars            
    })


});

function getArray(slr_level){
  const values = []
  if(slr_level == 0){
    
  for(let row =0; row<24;row++){
    let valueArray = [];
    for(let column =0; column<10;column++){
     valueArray.push(0);
    }
    values.push(valueArray);
    }
    
  } else {
  for(let row =0; row<24;row++){
    
    let valueArray = [];
    for(let column =0; column<10;column++){
      if (.5<pixel_data[row*10 + column][slr_level]/pixel_data[row*10 + column]["ORIGINAL AREA"] && pixel_data[row*10 + column][slr_level]/pixel_data[row*10 + column]["ORIGINAL AREA"]<.99)
        valueArray.push(1);
      else if ((pixel_data[row*10 + column][slr_level]/pixel_data[row*10 + column]["ORIGINAL AREA"])<=.5)
        valueArray.push(0);
      else if (pixel_data[row*10 + column][slr_level]/pixel_data[row*10 + column]["ORIGINAL AREA"]>=.99)
        valueArray.push(2);
    }
    
    values.push(valueArray);
  }}
    return values;
  
}

function grid (config) {
    /*
    * CREDIT FOR GRID TO @bryangingechen on Observable.
    */


  // defaults
  config = Object.assign({size:document.getElementById("pixel_viz").offsetWidth/19, numStates:3, margin:2, outline:'transparent'}, config);  
  let {nx, ny, size, numStates, init, margin, colorArray, outline} = config;

  // validate init: this is horrible...
  if (init !== undefined) {
    if (init.some(d => d.length !== init[0].length) ||
        init.some(d => d.some(v => v<0 || v >= numStates || v != Math.round(v))))
      throw new Error(`init should be undefined or a rectangular matrix with integer entries between 0 and ${numStates-1}`);
    if (nx === undefined && ny !== undefined) {
      if (ny === init.length)
        nx = init[0].length;
      else throw new Error(`init length:${init.length} not equal to ny:${ny}`);
    } else if (ny === undefined && nx !== undefined) {
      if (nx === init[0].length)
        ny = init.length;
      else throw new Error(`init inner length:${init[0].length} not equal to nx:${nx}`);
    }
    else if (nx === undefined && ny === undefined) {
      ny = init.length;
      nx = init[0].length;
    }
  } else {
    if (nx === undefined && ny !== undefined)
      nx = ny;
    else if (ny === undefined && nx !== undefined)
      ny = nx;
    else if (nx === undefined && ny === undefined)
      ny = nx = 5;
  }
  
    colorArray = ["#0074e7", "#72b9ff", "#f9f9f9"];

  // Array of values, start out all 0 if init not defined
  const state = init ? init.map(d => d.slice()) : Array.from({length:ny}, d => Array(nx).fill(0));

  const svg = d3.select("#svg").attr("width",nx*(size+2*margin)).attr("height", ny*(size+2*margin));

   //const svg = d3.select(DOM.svg(nx*(size+2*margin), ny*(size+2*margin)));
  const el = svg.node();

  const rectData = [];
  for (let y=0; y<ny; y++)
    for (let x=0; x<nx; x++)
      rectData.push({x,y});

  const grid = svg.append("g")
      .attr("cursor", "pointer")
    .selectAll("rect")
    .data(rectData)
    .join("rect")
      .attr("x", d => d.x*(size + 2*margin) + margin)
      .attr("y", d => d.y*(size + 2*margin) + margin)
      .attr("fill", d => colorArray[state[d.y][d.x]])
      .attr("stroke", outline)
      .attr("width", size)
      .attr("height", size);
  el.addEventListener('inputArray', ({detail}) => {
    if (detail !== null && detail !== undefined) {
      if (detail.length === ny &&
          detail.every(d => d.length === nx && d.every(v => v < numStates && v >= 0 && v === Math.round(v)))) {
        state = detail;
      } else
        return console.log(`failed inputArray event: ${detail}`);
    } else {
      state = init ? init.map(d => d.slice()) : Array.from({length:ny}, d => Array(nx).fill(0));
    }
    el.value = state;
    grid.attr("fill", d => colorArray[state[d.y][d.x]]);
    el.dispatchEvent(new CustomEvent('input'));
  });

  el.value = state;
  return el;
}



function getPosition(marker) { // gets the position roughly when the marker enters the frame
    return ($(`#${marker}`).offset().top-760)
}

function hideLayer(layer){ // layer must be passed as a string in quotes
    map.setPaintProperty(layer, 'fill-opacity', 0); // setting the CSS property of the SVG to 0, hiding it
};

function showLayer(layer){ // layer must be passed as a string in quotes
    map.setPaintProperty(layer, 'fill-opacity', 1); // setting the CSS property of the SVG to 0, showing it
    map.setLayoutProperty(layer, 'visibility', 'visible');
};
function showRasterLayer(layer){ // layer must be passed as a string in quotes
    map.setLayoutProperty(layer, 'visibility', 'visible');
};
function hideRasterLayer(layer){ // layer must be passed as a string in quotes
    map.setLayoutProperty(layer, 'visibility', 'none');
};
function revealLayer(layer){ // layer must be passed as a string in quotes
    map.setPaintProperty(layer, 'fill-opacity', 1) // setting the CSS property of the SVG to 0, showing it
    map.setPaintProperty(layer, 'fill-translate', [0,0]); // setting the CSS property of the SVG to 0, showing it
};
$(document).ready(function(){
    $('#slr_meter').fadeOut();
})
$('.show').mouseover(function(){
    hideRasterLayer('bird_env');
    hideRasterLayer('invert_env');
    hideRasterLayer('fish_env');
    $('.show').removeClass('show_active');
    $(this).addClass('show_active');
    showRasterLayer(this.id);
})
$(window).scroll(function() { // whenever the page scrolls
    var height = $(window).scrollTop(); // current position

    if ((height  > getPosition('marker1')) && (height  < getPosition('marker2'))) { 
        grid({init: getArray(0)});
    } else if ((height  > getPosition('marker2')) && (height  < getPosition('marker3'))) { 
        showRasterLayer('bird_env');
        $('#slr_meter').fadeOut();
        hideRasterLayer('slr_1');
         grid({init: getArray(1)});
    } else if ((height  > getPosition('marker3')) && (height  < getPosition('marker4'))) {
        hideRasterLayer('bird_env');
        hideRasterLayer('fish_env');
        hideRasterLayer('invert_env');

        $('#slr_meter').fadeIn();
        showRasterLayer('slr_1');
        grid({init: getArray(1)});
        $('#counter').css('bottom','5%');
        $('#counter p').html('1');
        $('.wave, .wave2').css('bottom','0%');
    } else if ((height  > getPosition('marker4')) && (height  < getPosition('marker5'))) { 
        showRasterLayer('slr_2');
        hideRasterLayer('slr_3');
        grid({init: getArray(2)});
        $('#counter p').html('2')
        $('#counter').css('bottom','13%')
        $('.wave, .wave2').css('bottom','10%');
        $('.wave_filler').css('height','10%');     
 
    } else if ((height > getPosition('marker5')) && (height  < getPosition('marker6'))) { 
        showRasterLayer('slr_3')
        $('#counter p').html('3')
        grid({init: getArray(3)});
        $('#counter').css('bottom','21%')
        $('.wave, .wave2').css('bottom','20%');
        $('.wave_filler').css('height','20%');

        map.setFilter('bird_env', ['==', 'NAME', 'Piping plover']);
            showRasterLayer('bird_env');
            map.flyTo({
                center: [-90.7393522,30.0464164],
                zoom: 10,
                bearing: 0,
                speed: 0.2,
                curve: 1,
                easing: function (t) { return t; }
                });

        hideRasterLayer('slr_1')
        hideRasterLayer('slr_4')
    } else if ((height > getPosition('marker6')) && (height  < getPosition('marker7'))) { 

    } else if ((height > getPosition('marker7')) && (height  < getPosition('marker8'))) {
        showRasterLayer('slr_4')
        $('#counter p').html('4')

        $('#counter').css('bottom','29%')
        $('.wave, .wave2').css('bottom','30%');
        $('.wave_filler').css('height','30%');
        
        hideRasterLayer('slr_2')
        hideRasterLayer('slr_5')
        grid({init: getArray(4)});
    } else if ((height > getPosition('marker8')) && (height  < getPosition('marker9'))) { 
        showRasterLayer('slr_5')
        $('#counter p').html('5')
        $('#counter').css('bottom','37%')
        $('.wave, .wave2').css('bottom','40%');
        $('.wave_filler').css('height','40%');
        grid({init: getArray(5)});
        hideRasterLayer('slr_3')
        hideRasterLayer('slr_6')
    } else if ((height > getPosition('marker9')) && (height  < getPosition('marker10'))) { 
        showRasterLayer('slr_6')
        $('#counter p').html('6')
        $('#counter').css('bottom','45%')
        $('.wave, .wave2').css('bottom','50%');
        $('.wave_filler').css('height','50%');
        hideRasterLayer('slr_2')
        hideRasterLayer('slr_7')
        grid({init: getArray(6)});
        map.flyTo({
                center: [-92.8386999,29.867172],
                zoom: 9,
                bearing: 0,
                speed: 0.2,
                curve: 1,
                easing: function (t) { return t; }
                });
        showRasterLayer('slr_6_loss')
    } else if ((height > getPosition('marker10')) && (height  < getPosition('marker11'))) { 


    } else if ((height > getPosition('marker11')) && (height  < getPosition('marker12'))) { 
        showRasterLayer('slr_7')
        $('#counter p').html('7')
        $('#counter').css('bottom','56%')
        $('.wave, .wave2').css('bottom','60%');
        $('.wave_filler').css('height','60%');
        hideRasterLayer('slr_5')
        hideRasterLayer('slr_8')
        grid({init: getArray(7)});
    } else if ((height > getPosition('marker12')) && (height  < getPosition('marker13'))) { 
        showRasterLayer('slr_8')
        $('#counter p').html('8')
        $('#counter').css('bottom','66%')
        $('.wave, .wave2').css('bottom','70%');
        $('.wave_filler').css('height','70%');
        hideRasterLayer('slr_6')
        hideRasterLayer('slr_9')
        grid({init: getArray(8)});
    } else if ((height > getPosition('marker13')) && (height  < getPosition('marker14'))) { 
        showRasterLayer('slr_9')
        $('#counter p').html('9')
        $('#counter').css('bottom','76%')
        $('.wave, .wave2').css('bottom','80%');
        $('.wave_filler').css('height','80%');
        hideRasterLayer('slr_7')
        hideRasterLayer('slr_10')
        grid({init: getArray(9)});

    } else if (height > getPosition('marker14')) { 
        showRasterLayer('slr_10') 
        $('#counter p').html('10')
        $('#counter').css('bottom','86%')
        $('.wave, .wave2').css('bottom','90%');
        $('.wave_filler').css('height','90%');
        hideRasterLayer('slr_8')
        grid({init: getArray(10)});
    } else {
    }
})

</script>
</body>
</html>

